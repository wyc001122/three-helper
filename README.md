# Three.js 场景节点管理工具设计文档

## 概述

本工具旨在为 Three.js 开发者提供一个类似于 Blender 大纲视图的场景节点管理界面。基于 Vue.js 框架、Three.js 和 shadcn-vue 组件库，开发者可以方便地查看、编辑和管理 Three.js 场景中的节点（如 `Object3D`、`Mesh`、`Light` 等），并支持节点的增删改查、层级关系调整、属性编辑等功能。

---

## 功能需求

### 1. 场景节点树展示

- **功能描述**: 以树形结构展示当前 Three.js 场景中的所有节点，包括 `Scene`、`Object3D`、`Mesh`、`Light`、`Camera` 等。
- **交互设计**:
  - 支持展开/折叠节点。
  - 支持节点选中（点击节点时，场景中对应的物体高亮显示）。
  - 支持节点显示/隐藏（通过复选框或图标切换）。
  - 支持右键菜单，提供节点操作选项（如 `Console` 节点信息、导出、选中整个节点等）。

### 2. 节点详情面板

- **功能描述**: 选中节点后，展示节点的详细信息（如位置、旋转、缩放、材质等）。
- **交互设计**:
  - 在右侧显示详情面板。
  - 支持属性回显（如 `side` 属性为 `2` 时，显示为 `THREE.DoubleSide`）。
  - 支持悬停显示实际值（如 `THREE.DoubleSide` 悬停时显示 `2`）。

### 3. 节点层级关系调整

- **功能描述**: 允许用户调整节点的层级关系（如将一个节点拖拽到另一个节点下作为子节点）。
- **交互设计**:
  - 支持拖拽节点到目标节点上，自动调整层级关系。
  - 支持拖拽节点到空白区域，将其从父节点中移除。

### 4. 节点搜索与过滤

- **功能描述**: 提供搜索功能，允许用户快速查找场景中的节点。
- **交互设计**:
  - 在工具栏中提供搜索框，支持按名称搜索节点。
  - 支持按节点类型过滤（如只显示 `Mesh` 或 `Light` 节点）。

### 5. 多选节点导出

- **功能描述**: 允许用户多选节点并导出为模型文件（如 `.glb` 或 `.gltf`）。
- **交互设计**:
  - 支持按住 `Ctrl` 或 `Shift` 键多选节点。
  - 提供“导出选中节点”按钮，弹出文件保存对话框。

### 6. 右键菜单功能

- **功能描述**: 右键点击节点时，提供快捷操作选项。
- **交互设计**:
  - 支持 `Console` 节点信息（将节点信息打印到控制台）。
  - 支持导出节点（将节点导出为模型文件）。
  - 支持选中整个节点（包括其子节点）。
  - 
### 7. 右键菜单功能

- **功能描述**: 整体面板可以拖拽，收起等

---

## 技术实现

### 1. 前端框架

- 使用 `Vue.js` 作为前端框架，便于组件化开发和状态管理。

### 2. Three.js 集成

- 通过 `Three.js` 的 `Scene` 对象获取场景中的所有节点，并将其转换为树形结构数据。
- 使用 `Three.js` 的 `Raycaster` 实现节点选中时的物体高亮显示。

### 3. 数据管理

- 使用 `Pinia` 或 `Vuex` 管理场景节点的状态，确保节点树和属性面板的同步更新。

### 4. UI 组件库

- 使用 `shadcn-vue` 组件库构建用户界面，确保界面风格统一。

### 5. 文件操作

- 使用 `FileReader` 和 `Blob` API 实现场景文件的保存与加载。

---

## 界面设计

### 1. 主界面布局

- **左侧**: 场景节点树（使用 `shadcn-vue` 的树形组件）。
- **右侧**: 节点详情面板（使用 `shadcn-vue` 的表单和卡片组件）。
- **顶部**: 工具栏（包含搜索框、保存/加载按钮等，使用 `shadcn-vue` 的工具栏组件）。

### 2. 节点树样式

- 使用树形组件展示节点，支持展开/折叠。
- 节点图标根据节点类型显示（如 `Mesh` 显示方块图标，`Light` 显示灯泡图标等）。

### 3. 详情面板样式

- 使用卡片组件展示节点详情。
- 属性值使用 `shadcn-vue` 的输入框、滑块等组件进行编辑。

### 4. 右键菜单样式

- 使用 `shadcn-vue` 的上下文菜单组件，确保风格统一。

---

## 开发计划

### 阶段 1: 基础功能开发

- 实现场景节点树的展示与选中功能。
- 实现节点详情面板的基础展示功能。

### 阶段 2: 交互功能开发

- 实现节点的增删改查功能。
- 实现节点层级关系调整功能。

### 阶段 3: 高级功能开发

- 实现节点搜索与过滤功能。
- 实现多选节点导出功能。

### 阶段 4: 优化与测试

- 优化界面交互与性能。
- 进行功能测试与 bug 修复。

---

## 结语

本工具将为 Three.js 开发者提供强大的场景管理功能，提升开发效率与体验。通过 Vue.js 和 shadcn-vue 的结合，确保工具的高效性与美观性。
